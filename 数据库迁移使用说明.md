# æ•°æ®åº“è¿ç§»ä½¿ç”¨è¯´æ˜

## ğŸ¯ è¿ç§»ç›®æ ‡
ä¸º `project` è¡¨æ·»åŠ ä¸¤ä¸ªæ–°å­—æ®µï¼Œæ”¯æŒæ–°çš„é¡¹ç›®ä¿¡æ¯æ¥å£ï¼š
- `epc_manager`: é¡¹ç›®ç»ç†
- `entrust_manager`: é¡¹ç›®æ‰§è¡Œç»ç†

## ğŸ”§ è¿ç§»æ–¹å¼

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨è¿ç§»ï¼ˆæ¨èï¼‰
```bash
# è¿è¡ŒPythonè¿ç§»è„šæœ¬
python migrate_database.py
```

**è‡ªåŠ¨è¿ç§»ä¼šï¼š**
1. æ£€æŸ¥ODBCé©±åŠ¨æ˜¯å¦å®‰è£…
2. å°è¯•è¿æ¥æ•°æ®åº“
3. è‡ªåŠ¨æ£€æŸ¥å­—æ®µæ˜¯å¦å­˜åœ¨
4. è‡ªåŠ¨æ·»åŠ ç¼ºå¤±çš„å­—æ®µ

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨SQLè¿ç§»

å¦‚æœè‡ªåŠ¨è¿ç§»å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨æ‰‹åŠ¨SQLè„šæœ¬ï¼š

#### SQL Server
```bash
# ä½¿ç”¨SQL Server Management Studioæ‰§è¡Œ
sqlcmd -S 10.1.24.73,1433 -U sys_ai -P "Cjy@2025Ai" -d ai_doc_review -i migrate_project_fields.sql
```

#### MySQL
```bash
# ä½¿ç”¨MySQLå®¢æˆ·ç«¯æ‰§è¡Œ
mysql -h 10.1.24.73 -P 1433 -u sys_ai -p"Cjy@2025Ai" ai_doc_review < migrate_project_fields_mysql.sql
```

## âš ï¸ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1: ODBCé©±åŠ¨æœªæ‰¾åˆ°
**é”™è¯¯ä¿¡æ¯**: `æœªå‘ç°æ•°æ®æºåç§°å¹¶ä¸”æœªæŒ‡å®šé»˜è®¤é©±åŠ¨ç¨‹åº`

**è§£å†³æ–¹æ¡ˆ**:
1. **å®‰è£…ODBCé©±åŠ¨**ï¼ˆæ¨èï¼‰:
   - ä¸‹è½½åœ°å€: https://learn.microsoft.com/sql/connect/odbc/download-odbc-driver-for-sql-server
   - å®‰è£…: Microsoft ODBC Driver 17 for SQL Server

2. **ä½¿ç”¨æ‰‹åŠ¨SQLè„šæœ¬**:
   ```bash
   # ç›´æ¥æ‰§è¡ŒSQLè„šæœ¬
   python migrate_database.py
   # æŒ‰æç¤ºé€‰æ‹©æ‰‹åŠ¨è¿ç§»æ–¹å¼
   ```

### é—®é¢˜2: è¿æ¥æ•°æ®åº“å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. éªŒè¯æ•°æ®åº“é…ç½®ï¼ˆ.envæ–‡ä»¶ï¼‰
3. ç¡®è®¤æ•°æ®åº“æœåŠ¡è¿è¡ŒçŠ¶æ€

### é—®é¢˜3: å­—æ®µå·²å­˜åœ¨
**è§£å†³æ–¹æ¡ˆ**:
- è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å­—æ®µæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå·²å­˜åœ¨ä¼šè·³è¿‡
- ä¸éœ€è¦æ‰‹åŠ¨å¹²é¢„

## âœ… éªŒè¯è¿ç§»ç»“æœ

è¿ç§»å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š

### æ–¹æ³•1: ä½¿ç”¨è¿ç§»è„šæœ¬éªŒè¯
```bash
python migrate_database.py
```
è„šæœ¬ä¼šæ˜¾ç¤ºå½“å‰å­—æ®µçŠ¶æ€

### æ–¹æ³•2: æ•°æ®åº“æŸ¥è¯¢éªŒè¯

#### SQL Server
```sql
SELECT COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'project' AND COLUMN_NAME IN ('epc_manager', 'entrust_manager');
```

#### MySQL
```sql
DESCRIBE project;
-- æˆ–è€…
SELECT COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, COLUMN_COMMENT
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = 'project'
AND COLUMN_NAME IN ('epc_manager', 'entrust_manager');
```

## ğŸ”„ å›æ»šæ“ä½œ

å¦‚æœéœ€è¦å›æ»šï¼ˆåˆ é™¤æ–°æ·»åŠ çš„å­—æ®µï¼‰ï¼š

#### SQL Server
```sql
ALTER TABLE project DROP COLUMN IF EXISTS epc_manager;
ALTER TABLE project DROP COLUMN IF EXISTS entrust_manager;
```

#### MySQL
```sql
ALTER TABLE project DROP COLUMN IF EXISTS epc_manager;
ALTER TABLE project DROP COLUMN IF EXISTS entrust_manager;
```

## ğŸ“‹ è¿ç§»æ¸…å•

åœ¨æ‰§è¡Œè¿ç§»å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] å·²å¤‡ä»½å½“å‰æ•°æ®åº“
- [ ] ç¡®è®¤æ•°æ®åº“è¿æ¥é…ç½®æ­£ç¡®
- [ ] å·²åœæ­¢ç›¸å…³çš„åº”ç”¨æœåŠ¡
- [ ] å‡†å¤‡å¥½å›æ»šæ–¹æ¡ˆ

## ğŸ‰ è¿ç§»å®Œæˆ

è¿ç§»æˆåŠŸåï¼š

1. é‡å¯åº”ç”¨æœåŠ¡ï¼š`python start_service.py`
2. æµ‹è¯•æ–°çš„APIæ¥å£ï¼š`python test_new_api_response.py`
3. éªŒè¯å‰ç«¯é¡µé¢æ˜¾ç¤ºæ­£å¸¸

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
2. å°è¯•ä½¿ç”¨æ‰‹åŠ¨SQLè„šæœ¬
3. æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®
4. è”ç³»ç³»ç»Ÿç®¡ç†å‘˜

---
**æ›´æ–°æ—¶é—´**: 2025-12-17
**ç‰ˆæœ¬**: v1.0